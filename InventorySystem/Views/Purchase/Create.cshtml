@{
    Layout = "_Layout";
}
<h2>New Purchase</h2>

<form asp-action="Create" method="post">
    <div class="mb-3">
        <label>Supplier</label>
        <select name="supplierId" class="form-control">
            @foreach (var s in ViewBag.Suppliers)
            {
                <option value="@s.Id">@s.Name</option>
            }
        </select>
    </div>

    <table class="table table-bordered" id="purchaseTable">
        <thead>
            <tr>
                <th>Product</th>
                <th>Qty</th>
                <th>Rate</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <select name="productIds" class="form-control">
                        @foreach (var p in ViewBag.Products)
                        {
                            <option value="@p.Id">@p.Name</option>
                        }
                    </select>
                </td>
                <td><input name="qty" class="form-control" type="number" /></td>
                <td><input name="rate" class="form-control" type="number" /></td>
                <td><button type="button" class="btn btn-danger remove-row">X</button></td>
            </tr>
        </tbody>
    </table>

    <button type="button" class="btn btn-secondary" id="addRow">Add Product</button>
    <button type="submit" class="btn btn-success">Save Purchase</button>
</form>

<script>
    document.getElementById("addRow").addEventListener("click", function() {
        const table = document.querySelector("#purchaseTable tbody");
        const row = table.rows[0].cloneNode(true);
        table.appendChild(row);
    });
    document.addEventListener("click", function(e) {
        if (e.target.classList.contains("remove-row")) {
            e.target.closest("tr").remove();
        }
    });
</script>
